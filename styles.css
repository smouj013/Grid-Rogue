/* styles.css — Grid Rogue v0.1.9
   ✅ Objetivo v0.1.9:
   - Vida por corazones (UI en HUD, 10 base)
   - Buffs activos visibles como badges con stack (si >1) + soporte timer (p.ej Imán)
   - Panel de Upgrades con look mejorado + scroll interno
   - Layout estable (Topbar + HUD fijo + canvas grande)
   - Overlays sólidos
   - Opciones con scroll interno (sin “scroll fantasma” en el juego)
   - Dpad solo móvil y colocado en bordes
*/

:root{
  --hue: 220;

  --bg0:#06060a;
  --bg1:#0b0b10;

  --card: rgba(18,18,26,0.92);
  --glass: rgba(10,10,14,0.62);

  --stroke: rgba(255,255,255,0.10);
  --stroke2: rgba(255,255,255,0.06);

  --text: rgba(255,255,255,0.92);
  --muted: rgba(255,255,255,0.60);

  --accent: hsl(var(--hue) 90% 60%);
  --accent2: hsl(calc(var(--hue) + 22) 90% 60%);
  --danger: #ff3b59;

  --shadow: 0 18px 50px rgba(0,0,0,0.50);
  --shadow2: 0 10px 24px rgba(0,0,0,0.32);

  --r: 16px;
  --r2: 14px;

  --pad: 10px;
  --btnH: 40px;
  --tap: 44px;

  --focus: 0 0 0 3px rgba(105,168,255,0.25);

  --glowA: rgba(80,120,255,0.16);
  --glowB: rgba(255,170,60,0.12);

  --overlayBack: rgba(0,0,0,0.50);

  /* HUD: un poco más alto para HP + buffs */
  --hudH: 138px;

  --panelMaxW: 560px;
  --panelWideMaxW: 980px;

  --canvasMaxW: 980px;

  --railPad: 8px;
  --railPadDesktop: 12px;

  --vh: 1vh;

  /* Dpad sizing */
  --dpadBtn: 58px;
  --dpadGap: 10px;
  --dpadPad: 12px;

  /* Vida */
  --hpFull: rgba(255,80,110,0.92);
  --hpEmpty: rgba(255,255,255,0.18);
}

*{ box-sizing:border-box; }
html, body{ height:100%; }
html{ overscroll-behavior:none; }

body{
  margin:0;
  color: var(--text);
  background:
    radial-gradient(1200px 700px at 15% 10%, var(--glowA), transparent 62%),
    radial-gradient(1000px 600px at 85% 40%, var(--glowB), transparent 60%),
    radial-gradient(900px 520px at 40% 90%, rgba(120,255,180,0.06), transparent 65%),
    linear-gradient(180deg, var(--bg0), var(--bg1));

  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  overflow:hidden;

  -webkit-text-size-adjust:100%;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;
  user-select:none;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:.12;
  mix-blend-mode: overlay;
  background-image:
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,0.02) 0px,
      rgba(255,255,255,0.02) 1px,
      rgba(0,0,0,0.00) 2px,
      rgba(0,0,0,0.00) 4px
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255,255,255,0.015) 0px,
      rgba(255,255,255,0.015) 1px,
      rgba(0,0,0,0.00) 2px,
      rgba(0,0,0,0.00) 5px
    );
  transform: translateZ(0);
}

button, input, select{
  font-family:inherit;
  -webkit-tap-highlight-color:transparent;
}
button{ user-select:none; cursor:pointer; }
a{ color:inherit; }

.ms{
  font-family:"Material Symbols Rounded";
  font-weight:600;
  font-style:normal;
  font-size:18px;
  line-height:1;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  vertical-align:-0.18em;
  font-variation-settings:"FILL" 0, "wght" 600, "GRAD" 0, "opsz" 28;
}

:focus-visible{
  outline:none;
  box-shadow: var(--focus);
  border-radius:12px;
}

/* Inputs (nativo pero bonito) */
input[type="checkbox"]{ accent-color: var(--accent); }
input[type="range"]{ accent-color: var(--accent); }

/* ───────────────── App layout ───────────────── */
#app{
  height:100vh;
  height:calc(var(--vh) * 100);
  height:100svh;
  height:100dvh;
  display:flex;
  flex-direction:column;
  min-height:0;
}

/* ───────────────── Topbar ───────────────── */
.topbar{
  position:relative;
  z-index:80;
  padding:
    calc(8px + env(safe-area-inset-top))
    10px
    8px
    10px;

  border-bottom:1px solid var(--stroke2);
  background: rgba(8,8,12,0.72);
  backdrop-filter: blur(12px);

  display:grid;
  grid-template-columns: 1fr auto auto;
  grid-template-areas:"brand stats actions";
  align-items:center;
  gap:10px;
}

.brand{ grid-area:brand; display:flex; align-items:center; gap:10px; min-width:0; }
.brandDot{
  width:12px; height:12px;
  border-radius:50%;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  box-shadow: 0 0 0 4px rgba(255,255,255,0.05), 0 10px 28px rgba(0,0,0,0.35);
  flex:0 0 auto;
}
.brandText{ min-width:0; }
.brandTitle{ font-weight:950; letter-spacing:.2px; }
.brandSub{
  color:var(--muted);
  font-size:12px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  max-width:46ch;
}

.miniStats{
  grid-area:stats;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  flex-wrap:nowrap;
  min-width:0;
}

.pill{
  display:inline-flex;
  flex:0 0 auto;
  align-items:center;
  gap:8px;
  padding:7px 10px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  border:1px solid var(--stroke2);
  color: rgba(255,255,255,0.88);
  font-size:12.5px;
  white-space:nowrap;
  transition:border-color .15s ease, transform .12s ease, background .15s ease, box-shadow .15s ease;
}
.pill .pv{ display:inline-flex; align-items:center; }
.pill.subtle{ background: rgba(255,255,255,0.04); color: rgba(255,255,255,0.74); }
.pillBtn{ cursor:pointer; }
.pillBtn:hover{
  border-color: rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.07);
  box-shadow: 0 10px 22px rgba(0,0,0,0.22);
}
.pillBtn:active{ transform: translateY(1px); }

.pill.mini{ padding:6px 9px; font-size:12px; }
.pill.mini .ms{ font-size:16px; }

.actions{
  grid-area:actions;
  display:flex;
  align-items:center;
  gap:8px;
  justify-content:flex-end;
}

.iconBtn{
  height: var(--btnH);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:0 10px;
  border-radius:12px;
  border:1px solid var(--stroke2);
  background: rgba(255,255,255,0.06);
  color:var(--text);
  box-shadow: var(--shadow2);
  transition: transform .12s ease, border-color .15s ease, background .15s ease, box-shadow .15s ease;
}
.iconBtn:hover{
  border-color: rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.07);
  box-shadow: 0 14px 28px rgba(0,0,0,0.28);
}
.iconBtn:active{ transform: translateY(1px); }
.iconBtn:disabled{ opacity:.55; cursor:default; transform:none; box-shadow:none; }
.iconBtn.small{ height:36px; width:38px; padding:0; border-radius:11px; }

/* responsive topbar */
@media (max-width:820px){
  #pillMult{ display:none; }
  .brandSub{ max-width:28ch; }
}
@media (max-width:620px){
  #pillVersion{ display:none; }
  .brandSub{ display:none; }
}
@media (max-width:520px){
  #pillBest{ display:none; }
}
@media (max-width:560px){
  .topbar{
    grid-template-columns: 1fr auto;
    grid-template-areas:
      "brand actions"
      "stats stats";
    row-gap: 8px;
  }
  .miniStats{
    justify-content:flex-start;
    overflow-x:auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 2px;
    mask-image: linear-gradient(90deg, transparent 0, #000 18px, #000 calc(100% - 18px), transparent 100%);
  }
  .miniStats::-webkit-scrollbar{ display:none; }
}
@media (max-width:380px){
  #pillPlayer .pv{ display:none; }
  .pill.mini{ padding:6px 8px; }
}

/* ───────────────── Stage ───────────────── */
.stage{
  position:relative;
  z-index:1;
  flex:1;
  min-height:0;
  padding:0;
  display:flex;
}

.canvasWrap{
  position:relative;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:
    8px
    8px
    calc(8px + env(safe-area-inset-bottom))
    8px;
}

/* ───────────────── HUD fijo ───────────────── */
.hud{
  position:relative;
  z-index:12;
  pointer-events:none;

  height: var(--hudH);
  min-height: var(--hudH);
  max-height: var(--hudH);
  overflow:hidden;

  display:flex;
  justify-content:center;
  gap:10px;
}

.combo{
  width:100%;
  max-width: 860px;
  padding: 10px 12px;
  border-radius: var(--r2);
  background: var(--glass);
  border:1px solid rgba(255,255,255,0.10);
  backdrop-filter: blur(12px);
  box-shadow: 0 12px 26px rgba(0,0,0,0.30);
  position:relative;
  overflow:hidden;
}
.combo::after{
  content:"";
  position:absolute;
  inset:-1px;
  pointer-events:none;
  opacity:.55;
  background:
    radial-gradient(420px 220px at 20% 0%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(380px 220px at 85% 30%, rgba(255,255,255,0.05), transparent 60%);
}

.comboTop{
  position:relative;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}

.comboSeq{
  display:flex;
  gap:6px;
  flex-wrap:nowrap;
  overflow:hidden;
  min-width:0;
}
.comboSeq .chip{
  --chipc: rgba(255,255,255,0.20);
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding: 4px 8px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  font-size:12px;
  color: rgba(255,255,255,0.90);
  white-space:nowrap;
}
.comboSeq .chip .ms{
  font-size:16px;
  color: var(--chipc);
  filter: drop-shadow(0 6px 14px rgba(0,0,0,0.28));
}

.comboTimer{
  display:inline-flex;
  align-items:center;
  gap:6px;
  font-size:12px;
  color: rgba(255,255,255,0.78);
  white-space:nowrap;
}

.comboHint{
  margin-top:6px;
  font-size:12px;
  color: rgba(255,255,255,0.62);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.levelProg{
  margin-top: 10px;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

/* ─────────── HP + Buffs (nuevo) ─────────── */
.statusBar{
  position:relative;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin-bottom: 8px;
}

.hpWrap{
  display:flex;
  align-items:center;
  gap: 8px;
  min-width: 0;
}

.hpIcon{
  font-size: 16px;
  color: rgba(255,255,255,0.72);
  filter: drop-shadow(0 10px 22px rgba(0,0,0,0.35));
}

.hpHearts{
  display:flex;
  align-items:center;
  gap: 3px;
  flex-wrap:wrap;
  max-width: 280px;
}

.heart{
  font-size: 15px;
  line-height:1;
  letter-spacing:0;
  vertical-align:0;
  transform: translateZ(0);
  filter: drop-shadow(0 10px 16px rgba(0,0,0,0.28));
  transition: transform .12s ease, opacity .12s ease, color .12s ease;
  font-variation-settings:"FILL" 1, "wght" 700, "GRAD" 0, "opsz" 24;
}
.heart.full{ color: var(--hpFull); opacity: .95; }
.heart.empty{
  color: rgba(255,255,255,0.20);
  opacity: .55;
  font-variation-settings:"FILL" 0, "wght" 650, "GRAD" 0, "opsz" 24;
}

.hpText{
  font-size: 12px;
  color: rgba(255,255,255,0.72);
  padding: 3px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
}

/* Animaciones opcionales (JS puede añadir clases) */
.hpWrap.damage .heart.full{ animation: hpPulse .18s ease-out 1; }
@keyframes hpPulse{
  0%{ transform: scale(1); }
  60%{ transform: scale(1.18); }
  100%{ transform: scale(1); }
}

.buffBar{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap: 8px;
  flex-wrap:wrap;
  min-width: 0;
}
.buffBar:empty{ display:none; }

/* Badge de buff (JS lo crea dentro de #buffBar)
   Estructura recomendada:
   <div class="buffBadge" data-id="magnet" data-rarity="rare">
     <span class="ms">magnet</span>
     <span class="stack" hidden>2</span>
     <span class="timer"><span class="timerFill" style="width:65%"></span></span>
   </div>
*/
.buffBadge{
  pointer-events:none;
  position:relative;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width: 34px;
  height: 34px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.16);
  box-shadow: 0 12px 26px rgba(0,0,0,0.32);
  overflow:hidden;
}
.buffBadge .ms{
  font-size: 20px;
  color: rgba(255,255,255,0.92);
  filter: drop-shadow(0 10px 18px rgba(0,0,0,0.25));
}

.buffBadge::before{
  content:"";
  position:absolute;
  inset:-1px;
  pointer-events:none;
  opacity:.55;
  background:
    radial-gradient(240px 120px at 20% 0%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(240px 120px at 90% 30%, rgba(255,255,255,0.05), transparent 60%);
}

.buffBadge .stack{
  position:absolute;
  top: -6px;
  right: -6px;
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius: 999px;
  font-size: 11px;
  font-weight: 950;
  color: rgba(255,255,255,0.92);
  background: rgba(0,0,0,0.55);
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: 0 10px 20px rgba(0,0,0,0.35);
}
.buffBadge .stack[hidden]{ display:none; }

.buffBadge .timer{
  position:absolute;
  left: 6px;
  right: 6px;
  bottom: 6px;
  height: 3px;
  border-radius: 999px;
  background: rgba(255,255,255,0.12);
  overflow:hidden;
}
.buffBadge .timer[hidden]{ display:none; }

.buffBadge .timerFill{
  display:block;
  height: 100%;
  width: 100%;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 10px 20px rgba(0,0,0,0.28);
}

/* Rareza (buff) */
.buffBadge[data-rarity="common"]{ border-color: rgba(255,255,255,0.12); }
.buffBadge[data-rarity="rare"]{ border-color: rgba(106,176,255,0.26); }
.buffBadge[data-rarity="epic"]{ border-color: rgba(214,133,255,0.26); }
.buffBadge[data-rarity="legendary"]{ border-color: rgba(255,211,90,0.26); }

.levelRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  font-size:12px;
  color: rgba(255,255,255,0.78);
  margin-bottom:6px;
}
.levelRow .left{
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
}
#levelProgText{
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.progBar{
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  overflow:hidden;
}
.progFill{
  height:100%;
  width:0%;
  border-radius:999px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 10px 24px rgba(0,0,0,0.35);
  transition: width .10s linear;
}

.toast{
  pointer-events:none;
  position:absolute;
  top: 8px;
  right: 8px;
  padding: 10px 12px;
  border-radius: var(--r2);
  background: rgba(10,10,14,0.78);
  border:1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(12px);
  box-shadow: var(--shadow2);
  max-width: 60ch;
  font-size:13px;

  transform: translateY(-6px);
  opacity:0;
  transition: transform .18s ease, opacity .18s ease;
}
.toast.show{ transform: translateY(0); opacity:1; }

@media (max-width:520px){
  :root{ --hudH: 126px; }
  .combo{ padding: 9px 10px; }
  .comboSeq .chip span:not(.ms){ display:none; }
  .comboHint{ display:none; }
  .hpHearts{ gap: 2px; max-width: 200px; }
  .heart{ font-size: 14px; }
  .buffBadge{ width: 32px; height: 32px; border-radius: 13px; }
  .buffBadge .ms{ font-size: 19px; }
}
@media (max-height:720px){
  :root{ --hudH: 118px; }
  .canvasWrap{ gap: 6px; padding: 6px 6px calc(6px + env(safe-area-inset-bottom)) 6px; }
  .combo{ padding: 8px 10px; }
  .comboHint{ display:none; }
  .statusBar{ margin-bottom: 6px; }
}
@media (max-height:600px){
  :root{ --hudH: 96px; }
  #levelProg{ display:none; }
  .toast{ top: 6px; right: 6px; padding: 8px 10px; font-size: 12px; }
}

/* ───────────────── GameArea ───────────────── */
.gameArea{
  position:relative;
  flex:1;
  min-height:0;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius: var(--r);
  overflow:hidden;
}

/* Rail frame: centra + “pro” */
.railFrame{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: var(--railPad);
  position:relative;
}
@media (min-width: 820px){
  .railFrame{ padding: var(--railPadDesktop); }
}

#gameCanvas{
  display:block;
  border-radius: 18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.30);
  box-shadow: 0 18px 46px rgba(0,0,0,0.45);
  image-rendering: pixelated;
}

/* ───────────────── Dpad (solo móvil, JS decide hidden) ───────────────── */
.dpad{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:30;
}

/* Botones base */
.dpadBtn{
  pointer-events:auto;
  width: var(--dpadBtn);
  height: var(--dpadBtn);
  border-radius: 999px;
  border:1px solid rgba(255,255,255,0.14);
  background: rgba(20,20,30,0.30);
  color: rgba(255,255,255,0.92);
  box-shadow: 0 10px 24px rgba(0,0,0,0.35);
  backdrop-filter: blur(10px);
  display:flex;
  align-items:center;
  justify-content:center;
  transition: transform .10s ease, border-color .15s ease, background .15s ease;
}
.dpadBtn:hover{
  border-color: rgba(255,255,255,0.20);
  background: rgba(25,25,38,0.34);
}
.dpadBtn:active{ transform: translateY(1px) scale(0.98); }

/* Colocación en bordes */
#btnLeft, #btnRight, #btnUp, #btnDown{ position:absolute; }

/* Safe area bottom */
:root{
  --safeB: env(safe-area-inset-bottom);
  --safeL: env(safe-area-inset-left);
  --safeR: env(safe-area-inset-right);
}

#btnLeft{
  left: calc(var(--dpadPad) + var(--safeL));
  bottom: calc(var(--dpadPad) + var(--safeB));
}
#btnRight{
  left: calc(var(--dpadPad) + var(--safeL) + var(--dpadBtn) + var(--dpadGap));
  bottom: calc(var(--dpadPad) + var(--safeB));
}

#btnDown{
  right: calc(var(--dpadPad) + var(--safeR));
  bottom: calc(var(--dpadPad) + var(--safeB));
}
#btnUp{
  right: calc(var(--dpadPad) + var(--safeR));
  bottom: calc(var(--dpadPad) + var(--safeB) + var(--dpadBtn) + var(--dpadGap));
}

/* En pantallas MUY bajas, reduce tamaño para no tapar canvas */
@media (max-height: 620px){
  :root{ --dpadBtn: 52px; --dpadGap: 8px; --dpadPad: 10px; }
}
@media (max-height: 520px){
  :root{ --dpadBtn: 48px; --dpadGap: 8px; --dpadPad: 8px; }
}

/* ───────────────── Overlays / Panels ───────────────── */
.overlay{
  position:absolute;
  inset:0;
  z-index:60;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:
    max(12px, env(safe-area-inset-top))
    max(12px, env(safe-area-inset-right))
    max(12px, env(safe-area-inset-bottom))
    max(12px, env(safe-area-inset-left));
  background: var(--overlayBack);
  backdrop-filter: blur(8px);
}

.overlay[hidden]{ display:none !important; }

.panel{
  width: min(var(--panelMaxW), 92vw);
  max-height: min(86vh, calc(100vh - 20px));
  overflow:hidden;

  background: var(--card);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: var(--r);
  box-shadow: var(--shadow);
  padding: 14px;
  position:relative;
}

/* borde “pro” sutil */
.panel::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: calc(var(--r) + 1px);
  pointer-events:none;
  background:
    radial-gradient(520px 280px at 20% 0%, rgba(105,168,255,0.14), transparent 60%),
    radial-gradient(520px 280px at 90% 20%, rgba(255,211,90,0.10), transparent 62%);
  opacity:.55;
  mask:
    linear-gradient(#000, #000) content-box,
    linear-gradient(#000, #000);
  -webkit-mask:
    linear-gradient(#000, #000) content-box,
    linear-gradient(#000, #000);
  padding:1px;
}

.panel.wide{ width: min(var(--panelWideMaxW), 94vw); }

.panelHead{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 12px;
  margin-bottom: 10px;
}
.h2{
  font-size: 18px;
  font-weight: 950;
  letter-spacing: .2px;
}
.tiny{ font-size: 12px; }
.muted{ color: var(--muted); }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

.panelActions{
  display:flex;
  gap: 10px;
  justify-content:flex-end;
  flex-wrap:wrap;
  margin-top: 12px;
}

/* botones */
.btn{
  height: var(--tap);
  padding: 0 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.92);
  box-shadow: var(--shadow2);
  transition: transform .12s ease, border-color .15s ease, background .15s ease, box-shadow .15s ease;
}
.btn:hover{
  border-color: rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.08);
  box-shadow: 0 14px 28px rgba(0,0,0,0.30);
}
.btn:active{ transform: translateY(1px); }
.btn.primary{
  background: linear-gradient(90deg, rgba(105,168,255,0.22), rgba(255,211,90,0.16));
  border-color: rgba(105,168,255,0.22);
}
.btn.danger{
  background: rgba(255,59,89,0.12);
  border-color: rgba(255,59,89,0.22);
}
.btn:disabled{ opacity:.55; cursor:default; transform:none; box-shadow:none; }

/* Splash */
.splash{
  display:flex;
  align-items:center;
  gap: 12px;
  padding: 10px 10px 4px 10px;
}
.splashLogo{
  width: 48px;
  height: 48px;
  border-radius: 16px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow: var(--shadow2);
}
.splashLogo .ms{ font-size: 26px; }
.splashText .title{ font-weight: 950; font-size: 18px; }
.splashText .sub{ color: var(--muted); font-size: 12px; }

/* loading bar */
.loadingBar{
  height: 12px;
  border-radius: 999px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  overflow:hidden;
}
.loadingBarFill{
  height:100%;
  width: 65%;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  animation: loadMove 1.15s ease-in-out infinite;
}
@keyframes loadMove{
  0%{ transform: translateX(-35%); width: 45%; opacity: .55; }
  50%{ transform: translateX(0%); width: 75%; opacity: 1; }
  100%{ transform: translateX(35%); width: 45%; opacity: .55; }
}

/* dots */
.dots{ display:inline-flex; gap:4px; margin-left:6px; }
.dots .dot{
  width: 6px; height: 6px;
  border-radius:999px;
  background: rgba(255,255,255,0.55);
  animation: dotPulse 0.9s ease-in-out infinite;
}
.dots .dot:nth-child(2){ animation-delay: .12s; opacity: .75; }
.dots .dot:nth-child(3){ animation-delay: .24s; opacity: .55; }
@keyframes dotPulse{
  0%,100%{ transform: translateY(0); opacity: .35; }
  50%{ transform: translateY(-2px); opacity: 1; }
}

/* forms */
.form{ display:flex; flex-direction:column; gap: 10px; }
.label{ font-size: 12px; color: rgba(255,255,255,0.78); }
.row{ display:flex; align-items:center; gap:10px; }
.input, .select{
  height: var(--tap);
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.20);
  color: rgba(255,255,255,0.92);
  padding: 0 12px;
  outline:none;
}
.select{ padding-right: 10px; }

/* Options (scroll interno) */
.options, #optionsBody{
  max-height: min(72vh, calc(100vh - 170px));
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  padding: 10px 8px 12px 8px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.06);
  background: rgba(0,0,0,0.14);
}
.options::-webkit-scrollbar, #optionsBody::-webkit-scrollbar{ width: 10px; }
.options::-webkit-scrollbar-thumb, #optionsBody::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.10);
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,0.20);
}

.optGroupTitle{
  display:flex;
  align-items:center;
  gap: 8px;
  font-weight: 950;
  font-size: 13px;
  color: rgba(255,255,255,0.88);
  margin: 6px 0 6px 0;
}

.optRow{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 10px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.06);
  background: rgba(255,255,255,0.03);
  margin-bottom: 8px;
}
.optRow.danger{
  border-color: rgba(255,59,89,0.16);
  background: rgba(255,59,89,0.06);
}
.sliderRow input[type="range"]{ flex: 1; }

/* ───────────────── Upgrades (mejorado) ───────────────── */
.upgradesPanel{
  background:
    radial-gradient(900px 420px at 12% 0%, rgba(105,168,255,0.10), transparent 60%),
    radial-gradient(800px 420px at 92% 10%, rgba(255,211,90,0.08), transparent 62%),
    var(--card);
}

.panelBody{
  max-height: min(62vh, calc(100vh - 220px));
  overflow:auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  padding: 2px 2px 8px 2px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.06);
  background: rgba(0,0,0,0.10);
}
.panelBody::-webkit-scrollbar{ width: 10px; }
.panelBody::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,0.10);
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,0.20);
}

.upgradeChoices, #upgradeChoices{
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
  margin-top: 10px;
  padding: 10px;
  position:relative;
  z-index:1;
}

.upgradeChoices::before, #upgradeChoices::before{
  content:"";
  position:absolute;
  inset: 8px;
  pointer-events:none;
  opacity:.10;
  border-radius: 14px;
  background-image:
    repeating-linear-gradient(0deg, rgba(255,255,255,0.08) 0px, rgba(255,255,255,0.08) 1px, transparent 2px, transparent 18px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.06) 0px, rgba(255,255,255,0.06) 1px, transparent 2px, transparent 18px);
}

@media (max-width: 760px){
  .upgradeChoices, #upgradeChoices{ grid-template-columns: 1fr; }
}

.upCard{
  position:relative;
  border-radius: 16px;
  padding: 12px 12px;
  cursor:pointer;
  user-select:none;

  background: rgba(0,0,0,0.22);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 14px 30px rgba(0,0,0,0.34);

  transition: transform .12s ease, border-color .15s ease, background .15s ease, box-shadow .15s ease;
  outline:none;
}

.upCard::after{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: 17px;
  pointer-events:none;
  opacity:.55;
  background:
    radial-gradient(460px 220px at 20% 0%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(420px 220px at 85% 30%, rgba(255,255,255,0.05), transparent 60%);
}

.upCard:hover{
  transform: translateY(-1px);
  border-color: rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.03);
  box-shadow: 0 18px 38px rgba(0,0,0,0.40);
}
.upCard:active{ transform: translateY(0px) scale(0.995); }

/* Si app.js añade icono: <div class="upIcon"><span class="ms">...</span></div> */
.upIcon{
  width: 42px;
  height: 42px;
  border-radius: 14px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom: 8px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 12px 22px rgba(0,0,0,0.30);
}
.upIcon .ms{ font-size: 22px; }

.upTitle{
  font-weight: 1000;
  letter-spacing: .2px;
  margin-bottom: 6px;
}
.upDesc{
  color: rgba(255,255,255,0.72);
  font-size: 13px;
  line-height: 1.25;
  margin-bottom: 10px;
}
.upMeta{
  display:flex;
  flex-wrap:wrap;
  gap: 8px;
  align-items:center;
}

.badge, .upRarityBadge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding: 5px 9px;
  border-radius: 999px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.05);
  font-size: 12px;
  color: rgba(255,255,255,0.86);
}

/* Rareza por data-rarity (app.js setea card.dataset.rarity) */
.upCard[data-rarity="common"]{
  --rarC: rgba(255,255,255,0.14);
  border-color: rgba(255,255,255,0.11);
}
.upCard[data-rarity="rare"]{
  --rarC: rgba(106,176,255,0.34);
  border-color: rgba(106,176,255,0.22);
}
.upCard[data-rarity="epic"]{
  --rarC: rgba(214,133,255,0.34);
  border-color: rgba(214,133,255,0.22);
}
.upCard[data-rarity="legendary"]{
  --rarC: rgba(255,211,90,0.36);
  border-color: rgba(255,211,90,0.22);
}

.upCard[data-rarity]::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: 17px;
  pointer-events:none;
  opacity:.75;
  background:
    radial-gradient(520px 260px at 18% 0%, var(--rarC, rgba(255,255,255,0.14)), transparent 62%),
    radial-gradient(520px 260px at 90% 20%, rgba(255,255,255,0.06), transparent 62%);
  mask:
    linear-gradient(#000, #000) content-box,
    linear-gradient(#000, #000);
  -webkit-mask:
    linear-gradient(#000, #000) content-box,
    linear-gradient(#000, #000);
  padding:1px;
}

.upCard[data-rarity="rare"] .upRarityBadge{
  border-color: rgba(106,176,255,0.26);
  background: rgba(106,176,255,0.10);
}
.upCard[data-rarity="epic"] .upRarityBadge{
  border-color: rgba(214,133,255,0.26);
  background: rgba(214,133,255,0.10);
}
.upCard[data-rarity="legendary"] .upRarityBadge{
  border-color: rgba(255,211,90,0.28);
  background: rgba(255,211,90,0.10);
}

/* acciones upgrades mejor colocadas */
.upgradesActions{
  justify-content:space-between;
  margin-top: 12px;
}

/* ───────────────── GameOver ───────────────── */
.goBig{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap: 12px;
  margin: 10px 0 10px 0;
}
.goScore{
  font-size: 44px;
  font-weight: 1000;
  letter-spacing: .2px;
}
.goBest{
  font-size: 13px;
  color: rgba(255,255,255,0.78);
  display:flex;
  align-items:center;
  gap: 8px;
}
.goBest .v{
  font-weight: 950;
  color: rgba(255,255,255,0.92);
}

.stats, #goStats{
  display:flex;
  flex-direction:column;
  gap: 8px;
  padding: 10px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.18);
}
.stats .line, #goStats .line{
  display:flex;
  justify-content:space-between;
  gap: 10px;
  font-size: 13px;
  color: rgba(255,255,255,0.80);
}

/* ───────────────── Error ───────────────── */
.errMsg, #errMsg{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.18);
  color: rgba(255,255,255,0.88);
  font-size: 13px;
  white-space: pre-wrap;
}

/* ───────────────── Estado (opcional) ───────────────── */
body[data-state="loading"] .topbar{ opacity: 0.95; }
body[data-state="menu"] .topbar{ opacity: 1; }
body[data-state="playing"] .topbar{ opacity: 1; }
body[data-state="over"] .topbar{ opacity: 1; }

/* ───────────────── Motion safety ───────────────── */
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important; scroll-behavior:auto !important; }
}
